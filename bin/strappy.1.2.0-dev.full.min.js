/*
 JSKK v1.2.0-dev | (c) 2014 Timothy Chandler <tim@geomash.com> | <LICENSE> 
 Date Built: 2014-05-07
*/
$JSKK.Class.create("Strappy")({VERSION:"1.2.0",VERSION_MAJOR:1,VERSION_MINOR:2,VERSION_MICRO:0,VERSION_STAGE:"",VERSION_STAGE_NUM:0,config:{autoInitStateMgr:!1}},{}),define("strappy/Strappy",function(){}),function(a){define("strappy/trait/ComponentConnector",["strappy/Strappy"],function(){return function(){$JSKK.Trait.create({$namespace:"strappy.trait",$name:"ComponentConnector"})({init:function(a){this._component=a},getParentComponent:function(){return this._component},cmp:function(){return this._component},getCmpName:function(){return this.cmp().my.name},getRadioTower:function(){return this.cmp().radioTower},getStateMgr:function(){return this.cmp().stateMgr},getID:function(){return this.$reflect("namespace")+"."+this.$reflect("name")},getSafeID:function(){return this.cmp().getSafeID(cmp)},getCmp:function(a){return this.cmp().getCmp(a)},hasChildCmp:function(a){return Object.isDefined(this.cmp().components[a])},getStore:function(a){return this.cmp().getStore(a)},getController:function(a){return this.cmp().getController(a)},getView:function(a){return this.cmp().getView(a)},getViewCache:function(){return this.cmp().getViewCache()},getConfig:function(a){return this.cmp().getConfig(a)},getIID:function(){return this.cmp().getIID()},makeAttachPoint:function(a){return[this.getConfig("attachTo"),a].join(" ")},showChildComponent:function(a){return this.sendSignal(strappy.Signal.SHOW,"strappy",{iid:this.getCmp(a).getIID()}),this},hideChildComponent:function(a){return this.sendSignal(strappy.Signal.HIDE,"strappy",{iid:this.getCmp(a).getIID()}),this},setSharedState:function(a,b){return this.getStateMgr().getSharedState().set(a,b),this},getSharedState:function(a){return this.getStateMgr().getSharedState().get(a)},newInitQueue:function(a,b){return this.cmp().newInitQueue(a,b)},setState:function(){return this.cmp().setState.apply(this.cmp(),arguments)},getState:function(a){return this.cmp().getState(a)},getPublicState:function(){return this.cmp().getPublicState()},getPrivateState:function(){return this.cmp().getPrivateState()},sendSignal:function(a,b,c,d){return this.cmp().sendSignal(a,b,c,d)}})}.apply(a,arguments)})}(this),function(a){define("strappy/trait/signal/Send",["strappy/Strappy"],function(){return function(){$JSKK.Trait.create({$namespace:"strappy.trait.signal",$name:"Send"})({sendSignal:function(a,b,c,d){if(Object.isEmpty(a))throw new Error("Class "+this.$reflect("name")+" attempted to fire an empty signal.");return(Object.isUndefined(c)||Object.isNull(c))&&(c={}),c.origin=Object.isFunction(this.getIID)?this.getIID():this.$reflect("namespace")+"."+this.$reflect("name"),this.getRadioTower().fireEvent(a,new strappy.Signal({name:a,body:d,type:b,filter:c}))}})}.apply(a,arguments)})}(this),function(a){define("strappy/trait/signal/Receive",["strappy/Strappy"],function(){return function(){$JSKK.Trait.create({$namespace:"strappy.trait.signal",$name:"Receive"})({registerSignals:function(a){for(var b in a){if(!Object.isFunction(this[b]))throw new Error('Attempt to bind signal to undefined callback "'+b+'".');if(Object.isAssocArray(a[b])){if(!Object.isDefined(a[b].signal))throw new Error("Signal not defined for registerSignals.");Object.isDefined(a[b].filter)||Object.isDefined(a[b].type)?this.getRadioTower().observe(a[b].signal,function(b,c){return c.isForMe(a[b].type||null,a[b].filter||null)?this[b](c):void 0}.bind(this,b)):this.getRadioTower().observe(a[b].signal,this[b].bind(this))}else this.getRadioTower().observe(a[b],this[b].bind(this))}},registerSignalOnce:function(a,b){if(!Object.isFunction(b)){if(!Object.isFunction(this[b]))throw new Error('Attempt to bind signal to undefined callback "'+b+'".');b=this[b]}this.getRadioTower().observeOnce(a,function(a){var c=a.getBody();return c.id==this.getID()||c.component==this.getCmpName()?b(a):void 0}.bind(this))}})}.apply(a,arguments)})}(this),function(a){define("strappy/trait/signal/Bindable",["strappy/Strappy"],function(){return function(){$JSKK.Trait.create({$namespace:"strappy.trait.signal",$name:"Bindable"})({bindStatefulClick:function(){var a=$JSKK.toArray(arguments);return $JSKK.when(this,"_ready").isTrue(function(){for(var b=null,c=0,d=a.length;d>c;c++){var e=this.getContainer(),f=$(a[c][0]);b=f[0]==e[0]?f:$(a[c][0],e),b.length&&this.getStateMgr().registerStateChanger(b,a[c][1])}}.bind(this)),this},bindStateChanges:function(a){Object.isUndefined(this._stateBindings)&&(this._stateBindings={});for(var b in a){if(!Object.isFunction(this[a[b]]))throw new Error('Unable to bind state change event for stateful property "'+b+'" because the method "'+a[b]+'" has not been defined on view class "'+this.$reflect("namespace")+"."+this.$reflect("name"));this._stateBindings[b]=this[a[b]].bind(this)}return this},onStateChange:function(a,b,c){Object.isUndefined(this._stateBindings)&&(this._stateBindings={}),Object.isFunction(this._stateBindings[b])&&this._stateBindings[b](c)}})}.apply(a,arguments)})}(this),function(a){define("strappy/Signal",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"Signal",$uses:["strappy.trait.signal.Send"]})({COMPONENT_IS_READY:"strappy.component.ready",STATE_CHANGE:"strappy.state.change",CMP_DO_RECONFIGURE:"strappy.component.do.reconfigure",SHOW:"strappy.component.show",HIDE:"strappy.component.hide"},{config:{name:null,body:null,type:null,filter:{}},init:function(a){this.config.name=a.name||null,this.config.body=a.body||null,this.config.type=a.type||null,this.config.filter=a.filter||{}},getName:function(){return this.config.name},getRadioTower:function(){return window.strappy.$radioTower},getBody:function(){return this.config.body},getType:function(){return this.config.type},getFilter:function(){return this.config.filter},isForMe:function(a,b){if(!Object.isNull(a)&&this.getType()!=a)return!1;if(!Object.isNull(b)){var c=this.getFilter();for(var d in b)if(Object.isUndefined(c[d])||b[d]!=c[d])return!1}return!0},resend:function(a,b){return Object.isUndefined(b)&&(b=this.getBody()),Object.isUndefined(a.origin)&&Object.isDefined(this.getFilter().origin)&&(a.origin=this.getFilter().origin),this.sendSignal(this.getName(),this.getType(),a,b),this}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/proxy/AbstractProxy",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data.proxy",$name:"AbstractProxy",$abstract:!0,$uses:["$JSKK.trait.Configurable","$JSKK.trait.Observable"]})({},{config:{url:""},events:{onBeforeRequest:!0},raw:$JSKK.Class.ABSTRACT_METHOD,_onDone:$JSKK.Class.ABSTRACT_METHOD})}.apply(a,arguments)})}(this),function(a){define("strappy/data/proxy/Ajax",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data.proxy",$name:"Ajax",$extends:"strappy.data.proxy.AbstractProxy"})({},{get:function(a){a.url=this.config.url,this.fireEvent("onBeforeRequest",this,a)!==!1&&(Object.isUndefined(a.method)&&(a.method="POST"),$.get({type:a.method,url:a.url,data:a.filter||{}}).done(this._onDone.bind(this,a)).fail(a.onFailure||$JSKK.emptyFunction))},sync:function(a){a.url=this.config.url,this.fireEvent("onBeforeRequest",this,a)!==!1&&$.ajax({type:"POST",url:a.url,data:a.data||{}}).done(this._onDone.bind(this,a)).fail(a.onFailure||$JSKK.emptyFunction)},raw:function(a){console.debug("RAW DATA:",$.stringify(a.data)),a.url=this.config.url,this.fireEvent("onBeforeRequest",this,a)!==!1&&$.ajax({type:"POST",contentType:"application/json",processData:!1,url:a.url,data:$.stringify(a.data)||{}}).done(this._onDone.bind(this,a)).fail(a.onFailure||$JSKK.emptyFunction)},_onDone:function(a,b){b.success?(a.onSuccess||$JSKK.emptyFunction)(b):(a.onFailure||$JSKK.emptyFunction)(b)}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/proxy/BTL",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data.proxy",$name:"BTL",$extends:"strappy.data.proxy.AbstractProxy"})({},{raw:function(a){if(a.url=this.config.url,this.fireEvent("onBeforeRequest",this,a)!==!1){var b=[];$.ajax({type:"POST",contentType:"application/json",processData:!1,url:a.url,data:JSON.stringify(a.data,function(a,c){if("object"==typeof c){if(b.indexOf(c)>=0)return;b.push(c)}return c})||{}}).done(this._onDone.bind(this,a)).fail(function(){console.warn("BTL Proxies raw() method hasn't been confiugred to deal with failures.")})}return this},_onDone:function(a,b){b.success?(a.onSuccess||$JSKK.emptyFunction)(b):(a.onFailure||$JSKK.emptyFunction)(b)}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/proxy/MemoryProxy",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data.proxy",$name:"MemoryProxy",$extends:"strappy.data.proxy.AbstractProxy"})({},{raw:function(a){this._onDone(a)},sync:function(a){this._onDone(a)},_onDone:function(a){(a.onSuccess||$JSKK.emptyFunction)({})}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/BTL",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data",$name:"BTL",$uses:["$JSKK.trait.Configurable","$JSKK.trait.Observable"],$requires:["strappy.data.proxy.BTL"]})({APIMethod:function(a,b,c,d){this.proxy.raw({url:this.config.url,data:{timestamp:(new Date).getTime(),call:a,data:b||null,query:c||null},onSuccess:function(a){this.fireEvent("onAnySuccess",this,a)!==!1&&Object.isFunction(d)&&d(a)}.bind(this),onFailure:function(a){this.fireEvent("onAnyFailure",this,a)!==!1&&Object.isFunction(d)&&d(a)}.bind(this)})}},{config:{url:"",debug:!1,proxy:null},events:{onAnySuccess:!0,onAnyFailure:!0},ready:!1,proxy:null,API:{},queue:null,debugWindow:null,init:function(){(Object.isUndefined(this.config.proxy)||Object.isNull(this.config.proxy))&&(this.config.proxy=strappy.data.proxy.BTL),this.proxy=new this.config.proxy({url:this.config.url}),this.getServiceAPI()},onReady:function(a){$JSKK.when(this,"ready").isTrue(a)},getServiceAPI:function(){$.ajax({type:"GET",url:this.config.url}).done(this.createAPIMethods.bind(this)).fail(function(){console.debug("SERVICE LOAD ERROR",arguments)})},createAPIMethods:function(a){var b=null,c=0,d=0;for(b in a)for(this.API[b]={},c=0,d=a[b].length;d>c;c++)this.API[b][a[b][c]]=this.$reflect("self").APIMethod.bind(this,b+"."+a[b][c]);this.ready=!0},setProxy:function(a,b){return this.proxy=new this.config.proxy({url:b||this.config.url}),this},bindType:function(a,b){return a._type=b,a},startQueue:function(){return this.queue=new strappy.data.Queue,this.queue.attachProxy(this.proxy),this},executeQueue:function(){return this.queue.execute(),this}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/AbstractStore",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data",$name:"AbstractStore",$abstract:!0,$uses:["strappy.trait.ComponentConnector","$JSKK.trait.Observable"]})({},{events:{onChange:!0,onSync:!0,onSyncFailed:!0,onModelChange:!0,onModelRemove:!0,onModelLockChange:!0},proxy:null,sharedFrom:null,model:null,data:{},record:null,transactions:[],ready:!1,init:function(){if(Object.isNull(this.proxy)&&(this.proxy=new strappy.data.proxy.MemoryProxy),Object.isString(this.sharedFrom)&&(this.sharedFrom=$JSKK.namespace(this.sharedFrom)),Object.isString(this.model))try{this.model=$JSKK.strToObject(this.model),this.ready=!0}catch(a){$JSKK.require(this.model,function(){this.model=$JSKK.namespace(this.model),this.ready=!0}.bind(this))}},newRecord:function(a){var b=this.model;return this.isShared()&&(b=this.getShared().model),new b({onLockChange:function(a,b){this.fireEvent("onModelLockChange",this,a,b)}.bind(this)},a)},bindChangeEvent:function(a){var b=this.$reflect("namespace")+"."+this.$reflect("name");return Object.isUndefined(a._storeChangeEvent[b])?a._storeChangeEvent[b]=this.onModelChange.bind(this):a.unobserve("onChange",a._storeChangeEvent[b]),a.observe("onChange",a._storeChangeEvent[b]),this},bindRemoveEvent:function(a){var b=this.$reflect("namespace")+"."+this.$reflect("name");return Object.isUndefined(a._storeRemoveEvent[b])?a._storeRemoveEvent[b]=this.onModelRemove.bind(this):a.unobserve("onRemove",a._storeRemoveEvent[b]),a.observe("onRemove",a._storeRemoveEvent[b]),this},onModelChange:function(a){if(this.isModelInAnyTransaction(a)){for(var b=!1,c=0,d=this.transactions.length;d>c&&!b;c++)for(var e=0,f=this.transactions[c].models.length;f>e;e++)if(this.transactions[c].models[e]==a){b=c;break}if(b===!1)throw new Error("Unable to locate a model within a transaction. BTW, this should never happen! IOW - You're screwed :)");1===this.transactions[b].models.length?(this.releaseModelFromTransaction(a,this.transactions[b].transaction),this.releaseTransaction(this.transactions[b].transaction),this.fireEvent("onChange",this,a)):this.releaseModelFromTransaction(a,this.transactions[b].transaction)}else this.fireEvent("onModelChange",this,a)},onModelRemove:function(a){if(this.isModelInAnyTransaction(a)){for(var b=!1,c=0,d=this.transactions.length;d>c&&!b;c++)for(var e=0,f=this.transactions[c].models.length;f>e;e++)if(this.transactions[c].models[e]==a){b=c;break}if(b===!1)throw new Error("Unable to locate a model within a transaction. BTW, this should never happen! IOW - You're screwed :)");1===this.transactions[b].models.length?(this.releaseModelFromTransaction(a,this.transactions[b].transaction),this.releaseTransaction(this.transactions[b].transaction),this.fireEvent("onChange",this,a)):this.releaseModelFromTransaction(a,this.transactions[b].transaction)}else this.fireEvent("onModelRemove",this,a)},getModel:function(){return this.model},get:$JSKK.Class.ABSTRACT_METHOD,set:$JSKK.Class.ABSTRACT_METHOD,sync:$JSKK.Class.ABSTRACT_METHOD,setProxy:function(a){return this.proxy=a,this},getProxy:function(){return this.proxy},isDirty:$JSKK.Class.ABSTRACT_METHOD,isShared:function(){return Object.isAssocArray(this.sharedFrom)&&Object.isFunction(this.sharedFrom.$reflect)},getShared:function(){return this.sharedFrom},informModelIsInTransaction:function(a,b){if(this.hasRecordedTransaction(b)||this.recordTransaction(b),this.isModelInAnyTransaction(a)&&!this.isModelInTransaction(a,b))throw new Error("A model cannot be attached to two transactions at any given time.");this.isModelInTransaction(a,b)||this.recordModelInTransaction(a,b)},hasRecordedTransaction:function(a){for(var b=0,c=this.transactions.length;c>b;b++)if(this.transactions[b].transaction==a)return!0},recordTransaction:function(a){return this.transactions.push({transaction:a,models:[]}),this},releaseTransaction:function(a){for(var b=[],c=0,d=this.transactions.length;d>c;c++)this.transactions[c].transaction!=a&&b.push(this.transactions[c]);return this.transactions=b,this},isModelInTransaction:function(a,b){for(var c=0,d=this.transactions.length;d>c;c++)if(this.transactions[c].transaction==b)for(var e=0,f=this.transactions[c].models.length;f>e;e++)if(this.transactions[c].models[e]==a)return!0;return!1},isModelInAnyTransaction:function(a){for(var b=0,c=this.transactions.length;c>b;b++)for(var d=0,e=this.transactions[b].models.length;e>d;d++)if(this.transactions[b].models[d]==a)return!0;return!1},recordModelInTransaction:function(a,b){for(var c=0,d=this.transactions.length;d>c;c++)if(this.transactions[c].transaction==b){this.transactions[c].models.push(a);break}return this},releaseModelFromTransaction:function(a,b){for(var c=[],d=0,e=this.transactions.length;e>d;d++)if(this.transactions[d].transaction==b){for(var f=0,g=this.transactions[d].models.length;g>f;f++)this.transactions[d].models[f]!=a&&c.push(this.transactions[d].models[f]);this.transactions[d].models=c;break}return this}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/SingleModelStore",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data",$name:"SingleModelStore",$extends:"strappy.data.AbstractStore",$abstract:!0})({},{BTL:null,BTL_GET:null,BTL_GET_QUERY:null,BTL_SET:null,BTL_REMOVE:null,BTL_CHECK:null,init:function(){if(this.init.$parent(),this.isShared()){var a=this.getShared(),b=a.newRecord(this.data);this.getShared().add(records),this.bindChangeEvent(b),this.bindRemoveEvent(b),this.record=a.record,Object.isString(a.BTL)&&(a.BTL=$JSKK.namespace(a.BTL),Object.isString(a.BTL_GET)&&(a.BTL_GET=$JSKK.namespace(a.BTL_GET)),Object.isString(a.BTL_SET)&&(a.BTL_SET=$JSKK.namespace(a.BTL_SET)),Object.isString(a.BTL_REMOVE)&&(a.BTL_REMOVE=$JSKK.namespace(a.BTL_REMOVE)),Object.isString(a.BTL_CHECK)&&(a.BTL_CHECK=$JSKK.namespace(a.BTL_CHECK)))}else{if(Object.isNull(this.model)||!Object.isDefined(this.model))throw new Error('Store "'+this.$reflect("namespace")+"."+this.$reflect("name")+'" must be configured with a valid model.');this.record=this.newRecord(this.data),this.bindChangeEvent(this.record),this.bindRemoveEvent(this.record),delete this.data,Object.isString(this.BTL)&&(this.BTL=$JSKK.namespace(this.BTL),Object.isString(this.BTL_GET)&&(this.BTL_GET=$JSKK.namespace(this.BTL_GET)),Object.isString(this.BTL_SET)&&(this.BTL_SET=$JSKK.namespace(this.BTL_REMOVE)),Object.isString(this.BTL_REMOVE)&&(this.BTL_REMOVE=$JSKK.namespace(this.BTL_REMOVE)),Object.isString(this.BTL_CHECK)&&(this.BTL_CHECK=$JSKK.namespace(this.BTL_CHECK)))}},get:function(a){return this.record.get(a)},getRecord:function(){return this.record},getRawRecord:function(){return this.record.record},set:function(){return this.record.set.apply(this.record,$JSKK.toArray(arguments)),this},sync:function(a,b){var c=this.isShared()?this.getShared():this;if(Object.isAssocArray(c.BTL))c.BTL.startQueue(),c.isDirty()&&c.BTL_SET([c.record]),c.BTL_GET(a,b,function(a){var b=a.data;c.record=c.newRecord(b[0]),c.fireEvent("onChange",c,b[0]),c.fireEvent("onSync",c,b[0])}.bind(c)),c.BTL.executeQueue();else{if(!c.proxy||!Object.isFunction(c.proxy.sync))throw new Exception('The store "'+c.$reflect("namespace")+"."+c.$reflect("name")+'" cannot be synced as it does not have a syncable proxy attached.');var d=[];c.isDirty()&&(d=[c.record]),c.proxy.sync({data:d,onSuccess:function(a){c.record=c.newRecord(a.data[0]),c.fireEvent("onChange",c,a),c.fireEvent("onSync",c,a)}.bind(c),onFailure:function(a){c.fireEvent("onSyncFailed",c,a)}.bind(c)})}},load:function(a){if(!this.proxy||!Object.isFunction(this.proxy.get))throw new Exception('The store "'+this.$reflect("namespace")+"."+this.$reflect("name")+'" cannot be synced as it does not have a syncable proxy attached.');return this.proxy.get({filter:a,onSuccess:function(a){this.record=this.newRecord(a.data[0]),this.fireEvent("onChange",this,a),this.fireEvent("onLoad",this,a)}.bind(this),onFailure:function(a){this.fireEvent("onLoadFailed",this,a)}.bind(this)}),this},isDirty:function(){return this.record.isDirty()}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/MultiModelStore",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data",$name:"MultiModelStore",$extends:"strappy.data.AbstractStore",$abstract:!0})({},{BTL:null,BTL_GET:null,BTL_GET_QUERY:null,BTL_SET:null,BTL_REMOVE:null,BTL_CHECK:null,model:null,data:[],records:[],init:function(){this.init.$parent(),$JSKK.when(this,"ready").isTrue(function(){if(this.isShared()){var a=this.getShared(),b=a.newRecord(this.data);a.add(b);for(var c=0,d=b.length;d>c;c++)this.bindChangeEvent(b[c]),this.bindRemoveEvent(b[c]);this.records=a.records,Object.isString(a.BTL)&&(a.BTL=$JSKK.namespace(a.BTL),Object.isString(a.BTL_GET)&&(a.BTL_GET=$JSKK.namespace(a.BTL_GET)),Object.isString(a.BTL_SET)&&(a.BTL_SET=$JSKK.namespace(a.BTL_SET)),Object.isString(a.BTL_REMOVE)&&(a.BTL_REMOVE=$JSKK.namespace(a.BTL_REMOVE)),Object.isString(a.BTL_CHECK)&&(a.BTL_CHECK=$JSKK.namespace(a.BTL_CHECK)))}else{if(Object.isNull(this.model)||!Object.isDefined(this.model))throw new Error('Store "'+this.$reflect("namespace")+"."+this.$reflect("name")+'" must be configured with a valid model.');this.records=this.newRecord(this.data);for(var c=0,d=this.records.length;d>c;c++)this.bindChangeEvent(this.records[c]),this.bindRemoveEvent(this.records[c]);delete this.data,Object.isString(this.BTL)&&(this.BTL=$JSKK.namespace(this.BTL),Object.isString(this.BTL_GET)&&(this.BTL_GET=$JSKK.namespace(this.BTL_GET)),Object.isString(this.BTL_SET)&&(this.BTL_SET=$JSKK.namespace(this.BTL_SET)),Object.isString(this.BTL_REMOVE)&&(this.BTL_REMOVE=$JSKK.namespace(this.BTL_REMOVE)),Object.isString(this.BTL_CHECK)&&(this.BTL_CHECK=$JSKK.namespace(this.BTL_CHECK)))}}.bind(this))},newRecord:function(a){Object.isArray(a)||(a=[a]);for(var b=[],c=0,d=0,e=a.length;e>d;d++)c=b.push(this.newRecord.$parent(a[d])),b[c-1].bindStore(this);return b},each:function(a){return this.records.each(a),this},add:function(a){return this.ready?this._add(a):$JSKK.when(this,"ready").isTrue(this._add.bind(this,a)),this},_add:function(a){Object.isArray(a)||(a=[a]);for(var b=0,c=a.length;c>b;b++)Object.isFunction(a[b].$reflect)?a[b].bindStore(this):a[b]=this.newRecord(a[b])[0],this.records.push(a[b]),this.bindChangeEvent(a[b]),this.bindRemoveEvent(a[b]);return this.fireEvent("onChange",this),this},remove:function(a,b){var c=this.isShared()?this.getShared():this,d=[];Object.isFunction(c.BTL_REMOVE)&&c.BTL_REMOVE({_type:a.get("_type"),id:a.getId()},null);for(var e=0,f=this.records.length;f>e;e++)this.records[e]!=a&&d.push(this.records[e]);return this.records=d,b||(a.fireEvent("onRemove",a,this),this.fireEvent("onChange",this),this.fireEvent("onModelRemove",this,a)),this},removeAll:function(){return this.removeByRange(0,this.records.length),this},removeByRange:function(a,b,c){if(0>a||a>this.records.length)return this;if(a>b)return this;if(b>this.records.length)return this;var d=this.records.splice(a,b),e=this.isShared()?this.getShared():this;if(Object.isFunction(e.BTL_REMOVE)){e.BTL.startQueue();for(var f=0,g=d.length;g>f;f++)e.BTL_REMOVE({_type:d[f].get("_type"),id:d[f].getId()},null);e.BTL.executeQueue()}if(!c){for(var f=0,g=d.length;g>f;f++)d[f].fireEvent("onRemove",d[f],this),this.fireEvent("onModelRemove",this,d[f]);this.fireEvent("onChange",this)}return this},getRecordIndexByValue:function(a,b){var c=-1;return this.each(function(d,e){d.getRecord()[a]==b&&(c=e)}.bind(this)),c},getRecordIndex:function(a){var b=-1;return this.each(function(c,d){c.getRecord()===a&&(b=d)}.bind(this)),b},getAll:function(){return this.records},getAllFiltered:function(a,b){Object.isArray(a)||(a=[a]);var c=[];if(this.each(function(b){for(var d={},e=0,f=a.length;f>e;e++)d[a[e]]=b.get(a[e]);c.push(d)}),b&&a.length){for(var d=[],e=0,f=c.length;f>e;e++)d.push(c[e][a[0]]);return d}return c},getCount:function(){return this.records.length},getAt:function(a){return this.records[a]},first:function(){return this.getAt(0)},last:function(){return this.getAt(this.records.length-1)},get:function(){},set:function(){},getById:function(a){var b=null;return this.each(function(c){return c.getId()==a?(b=c,!1):void 0}.bind(this)),b},find:function(){var a=$JSKK.toArray(arguments),b={},c=[];return Object.isDefined(a[1])?b[a.shift()]=a.shift():b=a.shift(),this.each(function(a){for(var d in b)if(a.get(d)!=b[d])return!1;c.push(a)}.bind(this)),c},findBy:function(a){var b=[];return this.each(function(c){a(c)&&b.push(c)}),b},getGrouped:function(a){for(var b={},c=null,d=0,e=this.records.length;e>d;d++)c=this.records[d].get(a),Object.isUndefined(b[c])&&(b[c]=[]),b[c].push(this.records[d]);return b},setAll:function(){var a=$JSKK.toArray(arguments),b={},c=new strappy.data.Transaction;Object.isDefined(a[1])?b[a.shift()]=a.shift():b=a.shift(),c.start();for(var d=null,e=0,f=this.records.length;f>e;e++)d=c.attachModel(this.records[e]),d.set(b);return c.execute({onSuccess:function(){c.commit(),this.fireEvent("onChange",this)}.bind(this),onFailure:function(){c.rollback()}}),this},sync:function(a,b,c){var d=this.isShared()?this.getShared():this;if(Object.isAssocArray(d.BTL)){var e=[];d.getDirty().each(function(a){e.push(a.getRecord())-1}.bind(d)),d.BTL.startQueue(),e.length&&Object.isFunction(d.BTL_SET)&&d.BTL_SET(e),(Object.isUndefined(b)||Object.isNull(b))&&(b=d.BTL_GET_QUERY),d.BTL_GET(a,b,function(a){var b=a.data;d.records=d.newRecord(b),this.records=d.records;for(var e=0,f=d.records.length;f>e;e++)d.bindChangeEvent(d.records[e]),d.bindRemoveEvent(d.records[e]);d.fireEvent("onChange",d,b),d.fireEvent("onSync",d,b),Object.isFunction(c)&&c(this)}.bind(this)),d.BTL.executeQueue()}else{if(!d.proxy||!Object.isFunction(d.proxy.sync))throw new Error('The store "'+d.$reflect("namespace")+"."+d.$reflect("name")+'" cannot be synced as it does not have a syncable proxy attached.');var e=[];d.getDirty().each(function(a){e.push(a.getRecord())}),d.proxy.sync({data:e,onSuccess:function(a){d.records=d.newRecord(a.data),this.records=d.records;for(var b=0,c=d.records.length;c>b;b++)d.bindChangeEvent(d.records[b]),d.bindRemoveEvent(d.records[b]);d.fireEvent("onChange",d,a),d.fireEvent("onSync",d,a)}.bind(d),onFailure:function(a){d.fireEvent("onSyncFailed",d,a)}.bind(this)})}},flagAllDirty:function(){this.each(function(a){a.flagDirty()})},flagAllClean:function(){this.each(function(a){a.flagClean()})},isDirty:function(){var a=this.isShared()?this.getShared():this;return Boolean(a.getDirty().length)},getDirty:function(){var a=this.isShared()?this.getShared():this,b=[];return a.records.each(function(a){a.isDirty()&&b.push(a)}),b},configureBTL:function(a){if(!Object.isAssocArray(a.handler))throw new Error("Invalid BTL handler assigned with MultiModelStore.configureBTL().");if(!Object.isFunction(a.get))throw new Error("Invalid getter assigned with MultiModelStore.configureBTL().");if(!Object.isFunction(a.set))throw new Error("Invalid setter assigned with MultiModelStore.configureBTL().");return this.BTL=a.handler,this.BTL_GET=a.get,this.BTL_SET=a.set,this}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/Transaction",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data",$name:"Transaction"})({STATE_INIT:0,STATE_STARTED:1,STATE_COMITTED:2,STATE_COMPLETE:4,STATE_SUCCESS:8,STATE_FAILED:16,STATE_ROLLEDBACK:32},{models:[],queue:!1,state:0,lockState:"full",init:function(a){a!==!1&&(this.queue=new strappy.data.Queue)},attachModel:function(a){if(Object.isDefined(a)&&Object.isFunction(a.$reflect)){var b=a.getStore();b&&b.informModelIsInTransaction(a,this),a.lock(this.lockState);var c=a.clone();return a.attachPhantom(c),this.models.push(a),this.queue&&this.queue.attachProxy(a.getStore().getProxy()),c}throw new Error("Transactions can only be used with Models.")},start:function(){return this.state|=strappy.data.Transaction.STATE_STARTED,this.fullLock(),this},execute:function(a){var b={total:this.models.length,done:0,fails:0};return $JSKK.when(b,{object:"done",value:b.total}).isEqualTo(function(){0===b.fails?Object.isFunction(a.onSuccess)&&a.onSuccess():Object.isFunction(a.onFailure)&&a.onFailure()}.bind(this)),this.models.each(function(a){var c=a.getPhantom();c.isDirty()&&a.getStore()&&c.bindStore(a.getStore()).sync({onSuccess:function(){b.done++},onFailure:function(){b.done++,b.fails++}}).unbindStore()}),this.queue&&this.queue.execute(),this},commit:function(){return this.state|=strappy.data.Transaction.STATE_COMITTED,this.models.each(function(a,b){a.lock(strappy.mvc.Model.LOCK_NONE),a.set(a.getPhantom().getRecord()),a.destroyPhantom(),delete this.models[b]}.bind(this)),delete this.models,this},rollback:function(){return this.state|=strappy.data.Transaction.STATE_ROLLEDBACK,this.models.each(function(a,b){a.destroyPhantom(),delete this.models[b]}.bind(this)),delete this.models,this},fullLock:function(){return this.lockState="full",this.models.each(function(a){a.lock("full")}),this},readOnly:function(){return this.lockState="readonly",this.models.each(function(a){a.lock("readonly")}),this}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/Queue",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data",$name:"Queue"})({},{proxies:[],requests:{},executing:!1,nextSequence:1,attachProxy:function(a){return this.proxies.inArray(a)||(this.proxies.push(a),a.observe("onBeforeRequest",function(a,b){return this.executing?!0:(Object.isDefined(b.url)&&(Object.isUndefined(this.requests[b.url])&&(this.requests[b.url]=[]),b.sequence=this.nextSequence++,b.proxy=a,Object.isDefined(b.data)||(b.data=null),this.requests[b.url].push(b),delete b.url),!1)}.bind(this))),this},execute:function(){this.executing=!0;var a=null,b=[];for(a in this.requests){for(var c=0,d=this.requests[a].length;d>c;c++)Object.isUndefined(this.requests[a][c].data.timestamp)&&(this.requests[a][c].data.timestamp=Date.parse(new Date)),this.requests[a][c].data.sequence=this.requests[a][c].sequence,b.push(this.requests[a][c].data);this.requests[a][0].proxy.raw({data:b,onSuccess:this.__onDone.bind(this),onFailure:this.__onDone.bind(this),onComplete:this.__onDone.bind(this)})}return this},__onDone:function(a){for(var b=null,c=0,d=a.length;d>c;c++)b=this.getRequest(a[c].sequence),a[c].success?(Object.isFunction(b.onComplete)&&b.onComplete(a[c]),Object.isFunction(b.onSuccess)&&b.onSuccess(a[c])):(Object.isFunction(b.onComplete)&&b.onComplete(a[c]),Object.isFunction(b.onFailure)&&b.onFailure(a[c]))},push:function(a){return this.requests[a.url].push(a),delete a.url,this},getRequest:function(a){for(var b in this.requests)for(var c=0,d=this.requests[b].length;d>c;c++)if(this.requests[b][c].sequence==a)return this.requests[b][c];return null}})}.apply(a,arguments)})}(this),function(a){define("strappy/data/stateful/Store",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.data.stateful",$name:"Store",$extends:"strappy.data.SingleModelStore"})({ACCESS_PRIVATE:"private",ACCESS_PUBLIC:"public",LOCK_NONE:"none",LOCK_READONLY:"readonly",LOCK_FULL:"full"},{events:{onBeforeChange:!0,onChange:!0,onReady:!0},ready:!1,readyViews:[],stateMap:{},lockState:"none",keys:[],init:function(){this.model=strappy.mvc.stateful.Model,this.init.$parent(),this.mapStateProperties()},mapStateProperties:function(){var a=this.$reflect("self"),b=null;for(b in this.record.get(a.ACCESS_PRIVATE))this.stateMap[b]=a.ACCESS_PRIVATE;for(b in this.record.get(a.ACCESS_PUBLIC))this.stateMap[b]=a.ACCESS_PUBLIC},canManageStateItem:function(a){return this.stateMap[a]==this.$reflect("self").ACCESS_PUBLIC},set:function(){if(this.lockState!=strappy.data.stateful.Store.LOCK_NONE)throw new Error('Store "'+this.$reflect("name")+'" is in lock state "'+this.lockState+'" and so cannot be modified.');var a=$JSKK.toArray(arguments),b={},c=null,d=!1,e={};Object.isDefined(a[1])?b[a.shift()]=a.shift():b=a.shift();for(var f in b)c=this.stateMap[f],this.record.get(c)[f]!=b[f]&&this.fireEvent("onBeforeChange",this,f,b[f])!==!1&&(this.record.get(c)[f]=b[f],c==this.$reflect("self").ACCESS_PUBLIC&&(d=!0,e[f]=b[f]),this.fireEvent("onChange",this,f,b[f]));return d&&this.getStateMgr().updateState(e,!0),this},setReady:function(a){if(this.ready=a,a){var b=this.getStateMgr().getState();for(var c in b)for(var d in this.state)if(d==c){this.state[d]=b[c];break}this.fireEvent("onReady",this)}return this},isReady:function(){return this.ready},get:function(a){return this.get.$parent(this.stateMap[a])[a]},setViewReady:function(a){return this.readyViews.push(a),this},getReadyViews:function(){return this.readyViews},lock:function(a){if(!["none","readonly","full"].inArray(a))throw new Error('"'+a+'" is an invalid lock type. Valid locks are "none", "readonly" and "full".');return this.lockState=a,this},reset:function(){return this.set(this.data["private"]),this.set(this.data["public"]),this}})}.apply(a,arguments)})}(this),function(a){define("strappy/SharedState",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"SharedState",$extends:"strappy.data.stateful.Store"})({},{set:function(){if(this.lockState!=strappy.data.stateful.Store.LOCK_NONE)throw new Error('Store "'+this.$reflect("name")+'" is in lock state "'+this.lockState+'" and so cannot be modified.');var a=$JSKK.toArray(arguments),b={};Object.isDefined(a[1])?b[a.shift()]=a.shift():b=a.shift();for(var c in b)Object.isUndefined(this.record.fields[strappy.data.stateful.Store.ACCESS_PRIVATE][c])&&(this.record.fields[strappy.data.stateful.Store.ACCESS_PRIVATE][c]=null),this.fireEvent("onBeforeChange",this,c,b[c])!==!1&&(this.record.record[strappy.data.stateful.Store.ACCESS_PRIVATE][c]=b[c],this.fireEvent("onChange",this,c,b[c]))
},get:function(a){return this.record.record[strappy.data.stateful.Store.ACCESS_PRIVATE][a]}})}.apply(a,arguments)})}(this),function(a){define("strappy/StateMgr",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"StateMgr",$uses:["strappy.trait.signal.Send"]})({},{state:{},stateString:"",radioTower:null,sharedState:null,eventSupported:!1,supressNext:!1,init:function(){this.radioTower=strappy.$radioTower,this.sharedState=new strappy.SharedState,$(window).bind("hashchange",this.onHashChangeTest.bind(this)),this.onHashChange(null,!0);var a=window.location.hash;window.location.hash="welcome",function(){window.location.hash=a,this.bindHashEvent.defer(200,this)}.bind(this).defer(100)},onHashChangeTest:function(){this.eventSupported=!0},bindHashEvent:function(){this.eventSupported?$(window).bind("hashchange",this.onHashChange.bind(this)):this.monitorHashChange()},monitorHashChange:function(){$JSKK.when(function(){return window.location.hash.replace("#","")!=this.stateString}.bind(this)).isTrue(function(){this.onHashChange(),this.monitorHashChange()}.bind(this))},onHashChange:function(a,b){this.supressNext&&(b=!0,this.supressNext=!1),this.stateString=window.location.hash.replace("#",""),this.state=Object.isEmpty(this.stateString)?{}:this.parseStateString(this.stateString),b||this.sendSignal(strappy.Signal.STATE_CHANGE,"state",{},this.state)},registerStateChanger:function(a,b){b=this.parseStateString(b),a.click(this.updateState.bind(this,b,!1))},updateState:function(a){var b=[];for(var c in a)Object.isNull(a[c])&&b.push(c),this.state[c]=a[c];if(b.length){for(var a={},d=0,e=b.length;e>d;d++)a[b[d]]=null;this.sendSignal(strappy.Signal.STATE_CHANGE,"state",{},a)}window.location.hash=this.parseStateObject(this.state)},getState:function(){return this.state},parseStateString:function(a){for(var b=a.split("&"),c=null,d={},e=0,f=b.length;f>e;e++){if(c=b[e].split("="),["true","false","null"].inArray(c[1]))switch(c[1]){case"true":c[1]=!0;break;case"false":c[1]=!1;break;case"null":c[1]=null}d[c[0]]=c[1]}return d},parseStateObject:function(){var a=[];for(var b in this.state)Object.isNull(this.state[b])||a.push(b+"="+this.state[b]);return a.join("&")},getRadioTower:function(){return this.radioTower},getSharedState:function(){return this.sharedState}})}.apply(a,arguments)})}(this),function(a){define("strappy/mvc/Model",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.mvc",$name:"Model",$uses:["$JSKK.trait.Observable"]})({LOCK_NONE:"none",LOCK_READONLY:"readonly",LOCK_FULL:"full"},{events:{onSync:!0,onFailedSync:!0,onChange:!0,onRemove:!0,onLockChange:!0},_storeChangeEvent:{},_storeRemoveEvent:{},dirty:!1,phantom:!1,_clone:!1,idField:"id",fields:[],record:{},store:null,lockState:"none",eventsEnabled:!0,init:function(a){if(Object.isDefined(a)&&!Object.isNull(a)){this.record=Object.clone(this.fields);for(var b in this.fields)Object.isDefined(a[b])&&(this.record[b]=Object.clone(a[b]))}else for(var b in this.fields)this.record[b]=Object.clone(this.fields[b])},bindStore:function(a){return this.store=a,this},unbindStore:function(){return this.store=null,this},detachFromStore:function(){return this.store.remove(this),this},getStore:function(){return this.store},BTLSync:function(a){var b=this.getStore(),c=b.isShared()?b.getShared():b;if(c.BTL.startQueue(),this.isDirty())this.flagClean(),c.BTL_SET(this.getRecord(),null,function(b){var c=b.data;this.lock(strappy.mvc.Model.LOCK_NONE,!0),this.set(c),this.eventsEnabled&&(this.fireEvent("onSync",this,c),this.fireEvent("onChange",this,c)),Object.isFunction(a)&&a(this)}.bind(this));else{var d={};d[this.idField]=this.getId(),this.flagClean(),c.BTL_GET(null,d,function(b){var c=b.data;this.lock(strappy.mvc.Model.LOCK_NONE,!0),this.set(c[0]),this.eventsEnabled&&(this.fireEvent("onSync",this,c),this.fireEvent("onChange",this,c)),Object.isFunction(a)&&a(this)}.bind(this))}c.BTL.executeQueue()},sync:function(a){var b=this.getStore().getProxy();if(!Object.isFunction(b.sync))throw new Error('The model "'+this.$reflect("namespace")+"."+this.$reflect("name")+'" cannot be synced as it does not have a syncable proxy attached to its bound store.');return b.sync({data:this.isDirty()?this.record:{},onSuccess:function(b){Object.isDefined(b.data)&&(this.record=b.data),!this.isClone()&&this.eventsEnabled?(this.fireEvent("onSync",this),this.fireEvent("onChange",this)):Object.isFunction(a.onSuccess)&&a.onSuccess()}.bind(this),onFailure:function(){!this.isClone()&&this.eventsEnabled?this.fireEvent("onFailedSync",this):Object.isFunction(a.onFailure)&&a.onFailure()}.bind(this)}),this.flagClean(),this},get:function(a){if(-1===a.indexOf("."))return this.record[a];keyParts=a.split("."),value=this.record;for(var b=0,c=keyParts.length;c>b;b++)if(value=value[keyParts[b]],Object.isUndefined(value)){value=null;break}return value},getRecord:function(){if(this.lockState==strappy.mvc.Model.LOCK_NONE||this.lockState==strappy.mvc.Model.LOCK_READONLY||this.isClone())return this.record;throw new Error('The model "'+this.$reflect("namespace")+"."+this.$reflect("name")+'" is in a lock state that prevents reading.')},getId:function(){return Object.isString(this.idField)?this.get(this.idField):null},set:function(){var a=$JSKK.toArray(arguments),b={},c=!1;Object.isDefined(a[1])?b[a.shift()]=a.shift():b=a.shift();for(var d in b)if(-1===d.indexOf("."))this.record[d]!==b[d]&&(this.record[d]=b[d],c=!0);else{for(var e=d.split("."),f=this.record,g=0,h=e.length;h>g&&!Object.isUndefined(f[e[g]]);g++)g+1!=h&&(f=f[e[g]]);f[e[h-1]]!==b[d]&&(f[e[h-1]]=b[d],c=!0)}c&&this.flagDirty(),this.lockState==strappy.mvc.Model.LOCK_NONE&&!this.isClone()&&c&&this.eventsEnabled&&this.fireEvent("onChange",this)},flagDirty:function(){return this.dirty=!0,this},flagClean:function(){return this.dirty=!1,this},isDirty:function(){return this.dirty},isClean:function(){return!this.dirty},lock:function(a,b){if(!["none","readonly","full"].inArray(a))throw new Error('"'+a+'" is an invalid lock type. Valid locks are "none", "readonly" and "full".');return this.lockState=a,b!==!0&&!this.isClone()&&this.eventsEnabled&&this.fireEvent("onLockChange",this,this.lockState),this},clone:function(){var a=new(this.$reflect("self"))({},this.record);return a._clone=!0,a},isClone:function(){return this._clone},attachPhantom:function(a){return this.phantom=a,this},hasPhantom:function(){return Boolean(this.phantom)},getPhantom:function(){if(this.hasPhantom())return this.phantom;throw new Error('The model "'+this.$reflect("namespace")+"."+this.$reflect("name")+'" does not have a phantom model associated with it.')},destroyPhantom:function(){return delete this.phantom,this.phantom=null,this},enableEvents:function(){return this.eventsEnabled=!0,this},disableEvents:function(){return this.eventsEnabled=!1,this}})}.apply(a,arguments)})}(this),function(a){define("strappy/mvc/DynamicModel",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.mvc",$name:"DynamicModel",$extends:"strappy.mvc.Model"})({},{init:function(a){if(Object.isDefined(a)){this.record=Object.clone(this.fields);for(var b in a)Object.isUndefined(this.fields[b])&&(this.fields[b]=null),this.record[b]=Object.clone(a[b])}else for(var b in this.fields)Object.isUndefined(this.fields[b])&&(this.fields[b]=null),this.record[b]=Object.clone(this.fields[b])}})}.apply(a,arguments)})}(this),function(a){define("strappy/mvc/ViewCache",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.mvc",$name:"ViewCache"})({FETCHING:"~*~FETCHING~*~"},{cache:{},set:function(a,b){return this[String(a)]=String(b),this},get:function(a){return this[String(a)]||""},exists:function(a){return Object.isDefined(this[String(a)])},setFetching:function(a){return this[String(a)]=strappy.mvc.ViewCache.FETCHING,this},isFetching:function(a){return this[String(a)]===strappy.mvc.ViewCache.FETCHING}})}.apply(a,arguments)})}(this),function(a){define("strappy/mvc/View",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.mvc",$name:"View",$abstract:!0,$uses:["strappy.trait.ComponentConnector","strappy.trait.signal.Bindable","$JSKK.trait.Observable"]})({},{events:{onTemplatesLoaded:!0,onReady:!0,onShow:!0,onHide:!0},_templatesReady:!1,_ready:!1,_stateBindings:{},templates:{},element:null,stateStore:null,init:function(){this.fetchTemplateContent(function(){this._templatesReady=!0}.bind(this)),this.observe("onStateChange",this.onStateChange.bind(this))},fetchTemplateContent:function(a){var b=0,c=0;for(var d in this.templates)b++;for(var d in this.templates){var e=this.$reflect("namespace").replace(/\./g,"/")+"/html/"+this.templates[d];!this.getViewCache().exists(e)||this.getViewCache().isFetching(e)?this.getViewCache().isFetching(e)?$JSKK.when(function(){return this.getViewCache().isFetching(e)}.bind(this)).isFalse(function(a,b){this.templates[b]=this.getViewCache().get(a),c++}.bind(this,e,d)):(this.getViewCache().setFetching(e),$.get(e,function(a,b,d){this.templates[b]=d,this.getViewCache().set(a,d),c++}.bind(this,e,d)).fail(function(){console.warn('Missing template! "'+e+'" could not be loaded. Module will not initialize!')}.bind(this))):(this.templates[d]=this.getViewCache().get(e),c++)}$JSKK.when(function(){return b==c}).isTrue(function(){this.fireEvent("onTemplatesLoaded",this),a()}.bind(this))},getTemplate:function(a){return this.templates[a]},onAfterCmpInit:$JSKK.emptyFunction,onReady:$JSKK.emptyFunction,onViewInit:$JSKK.emptyFunction,onStateChange:$JSKK.emptyFunction,syncView:$JSKK.Class.ABSTRACT_METHOD,bindDOMEvents:$JSKK.Class.ABSTRACT_METHOD,getContainerClass:function(){return"."+this.getSafeID()},getContainer:function(){return $("#"+this.getIID())},show:function(){return this.getContainer().show(),this.getContainer().removeClass("hidden"),this.fireEvent("onShow",this),this},hide:function(){return this.getContainer().addClass("hidden"),this.getContainer().hide(),this.fireEvent("onHide",this),this},bindContainerEvent:function(a,b,c,d){return this.bindDOMEvent(a,null,b,c,d)},bindDOMEvent:function(a,b,c,d,e){var f=c.split(":");if(2==f.length)switch(f[0]){case"controller":f=this.getController(f[1]);break;case"view":f=this}else f=this.getController(c);return Object.isArray(b)?$(b[0],this.getContainer()).on(a,b[1],e,f[d].bind(f)):this.getContainer().on(a,b,e,f[d].bind(f)),this},bindBodyDOMEvent:function(a,b,c,d,e){var f=c.split(":");if(2==f.length)switch(f[0]){case"controller":f=this.getController(f[1]);break;case"view":f=this}else f=this.getController(c);return $("body").on(a,b,e,f[d].bind(f)),this},find:function(a){return this.getContainer().find(a)}})}.apply(a,arguments)})}(this),function(a){define("strappy/mvc/Controller",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.mvc",$name:"Controller",$abstract:!0,$uses:["strappy.trait.ComponentConnector","strappy.trait.signal.Receive","$JSKK.trait.Observable"]})({},{events:{},init:function(){this.registerSignals({_onSignalShow:{signal:strappy.Signal.SHOW,type:"strappy",filter:{iid:this.getIID()}},_onSignalHide:{signal:strappy.Signal.HIDE,type:"strappy",filter:{iid:this.getIID()}}})},onAfterCmpInit:$JSKK.emptyFunction,onReconfigure:$JSKK.emptyFunction,onViewReady:$JSKK.emptyFunction,onGotBaseHTML:$JSKK.emptyFunction,onReadyState:$JSKK.emptyFunction,_onSignalShow:function(){var a=this.getController("State");$JSKK.when(a.isReady.bind(a)).isTrue(this.onSignalShow.bind(this))},_onSignalHide:function(){var a=this.getController("State");$JSKK.when(a.isReady.bind(a)).isTrue(this.onSignalHide.bind(this))},onSignalShow:$JSKK.emptyFunction,onSignalHide:$JSKK.emptyFunction})}.apply(a,arguments)})}(this),function(a){define("strappy/mvc/stateful/Controller",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.mvc.stateful",$name:"Controller",$abstract:!0,$uses:["strappy.trait.ComponentConnector","strappy.trait.signal.Receive","strappy.trait.signal.Send","strappy.trait.signal.Bindable","$JSKK.trait.Observable"]})({},{events:{onBeforeReadyState:!0,onReadyState:!0},stateStore:null,onBeforeChange:$JSKK.Class.ABSTRACT_METHOD,ready:!1,init:function(){if(this.registerSignals({onStateChangeFromStateMgr:strappy.Signal.STATE_CHANGE}),!(this.stateStore=this.getStore("State")))throw new Error('Unable to initialize "'+this.$reflect("namespace")+"."+this.$reflect("name")+'" State Controller. Controller requires a state model.');this.stateStore.observe("onBeforeChange",this.onBeforeChange.bind(this)),this.stateStore.observe("onChange",this.onStateChange.bind(this))},onStateChangeFromStateMgr:function(a){if(this.stateStore.isReady()){var b=a.getBody();for(var c in b)if(this.stateStore.canManageStateItem(c)){var d=this.stateStore.get(c);if(!this.stateStore.set(c,b[c])){var e={};e[c]=d,this.getStateMgr().updateState(e,!0)}}}},onViewReady:$JSKK.emptyFunction,setReady:function(){if(this.stateStore.setReady(!0),this.ready=!0,this.fireEvent("onBeforeReadyState",this,!0)!==!1){var a=this.getStateMgr().getState();for(var b in a)if(this.stateStore.canManageStateItem(b)){var c=this.stateStore.get(b);if(!this.stateStore.set(b,a[b])){var d={};d[b]=c,this.getStateMgr().updateState(d,!0)}}this.fireEvent("onReadyState",this,!0)}return this},updateState:function(){return this.stateStore.set.apply(this.stateStore,$JSKK.toArray(arguments)),this},setViewReadyState:function(a){return this.stateStore.setViewReady(a),this},getReadyViews:function(){return this.stateStore.getReadyViews()},isReady:function(){return this.ready}})}.apply(a,arguments)})}(this),function(a){define("strappy/mvc/stateful/Model",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.mvc.stateful",$name:"Model",$extends:"strappy.mvc.Model"})({},{fields:{"private":{},"public":{}}})}.apply(a,arguments)})}(this),function(a){define("strappy/RadioTower",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"RadioTower",$uses:["$JSKK.trait.Observable"]})({},{events:{}})}.apply(a,arguments)})}(this),function(a){define("strappy/InitQueue",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"InitQueue",$uses:["$JSKK.trait.Observable"]})({},{events:{onItemReady:!0,onAllReady:!0},component:null,items:[],processPointer:-1,length:0,complete:0,init:function(a){Object.isDefined(a)?this.component=a:console.warn("You should provide the parent component to the InitQueue constructor otherwise initalized child components could be unreferencable.")},add:function(a,b,c,d){if(Object.isUndefined(b))throw new Error('InitQueue failed to add component. "ref" for component was undefined.',$.stringify(arguments));return this.items.push({name:a,ref:b,config:c,callback:d||$JSKK.emptyFunction}),this.length++,this},execute:function(){this.items.length&&($JSKK.when(this,{object:"complete",value:this.length}).isEqualTo(function(){this.fireEvent("onAllReady",this.items)}.bind(this)),this.processNextItem())},processNextItem:function(){if(this.processPointer++,Object.isString(this.items[this.processPointer].ref)&&(this.items[this.processPointer].ref=$JSKK.namespace(this.items[this.processPointer].ref)),!Object.isFunction(this.items[this.processPointer].ref.$reflect)){if(!Object.isFunction(this.items[this.processPointer].ref))throw new Error('InitQueue was unable to initalize a component. The component with ref "'+this.items[this.processPointer].name+'" did not have a valid constructor associated with it.');this.items[this.processPointer].ref=new this.items[this.processPointer].ref}cmp=this.items[this.processPointer].ref,Object.isDefined(this.component)&&!Object.isNull(this.component)&&Object.isUndefined(this.component.components[this.items[this.processPointer].name])&&(this.component.components[this.items[this.processPointer].name]=cmp),Object.isAssocArray(this.items[this.processPointer].config)?(cmp.observeOnce("onAfterInit",function(a){a.getController("State").observeOnce("onReadyState",function(){this.fireEvent("onItemReady",this.items[this.processPointer]),this.items[this.processPointer].callback(),++this.complete!=this.length&&this.processNextItem()}.bind(this,this.processPointer))}.bind(this,cmp)),cmp.configure(this.items[this.processPointer].config)):(this.complete++,this.processNextItem())}})}.apply(a,arguments)})}(this),function(a){define("strappy/Component",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"Component",$uses:["$JSKK.trait.Configurable","$JSKK.trait.Observable","strappy.trait.signal.Send"]})({ACCESS_PRIVATE:"private",ACCESS_PUBLIC:"public"},{events:{onConfigured:!0,onAfterInit:!0,onBeforeStateChange:!0,onStateChange:!0,onBeforeReadyState:!0,onReadyState:!0},browser:{name:null,version:null},components:{},stores:[],views:[],controllers:[],_stores:{},_views:{},_controllers:{},config:{},my:{name:null,index:null,NSObject:null},radioTower:null,stateMgr:null,viewCache:null,readyForConfig:!1,_iid:null,state:{"public":{},"private":{attachTo:null,attachHow:"append",ref:null,fullRef:null}},_state:{"public":{},"private":{attachTo:null,attachHow:"append",ref:null,fullRef:null}},stateMap:{},init:function(){this.my.name=this.$reflect("name"),this.my.fullName=this.$reflect("namespace")+"."+this.$reflect("name"),this.my.namespace=this.$reflect("namespace").split("."),this.my.childSpace=this.$reflect("namespace"),Object.isUndefined(window.strappy.$components)&&(window.strappy.$components={}),Object.isUndefined(window.strappy.$components[this.my.name])&&(window.strappy.$components[this.my.name]=[]),this.my.index=window.strappy.$components[this.my.name].push(this),this.my.NSObject=window;for(var a=0,b=this.my.namespace.length;b>a;a++)this.my.NSObject=this.my.NSObject[this.my.namespace[a]];this.initRadioTower(),this.initStateMgr(),this.initViewCache(),this.generateInstanceID(),this.initState(this.config),$JSKK.when(function(){return Boolean($("#"+this.getIID()).length)}.bind(this)).isTrue(function(){this.getState("ref")||this.setState("ref",this.my.fullName),this.initChildComponents();var a=0,b=function(){if(3==++a){var b=null;for(var c in this._controllers)this._controllers[c].onAfterCmpInit();for(var b in this._views)this._views[b].onAfterCmpInit(),this._views[b].bindDOMEvents(),this._views[b]._ready=!0,this._views[b].fireEvent("onReady",b);this.fireEvent("onAfterInit",this),this.onAfterInit()}}.bind(this);this.initStores(b),this.initViews(b),this.initControllers(b)}.bind(this)),this.insertBaseContainer()},onAfterInit:$JSKK.emptyFunction,initRadioTower:function(){Object.isUndefined(window.strappy.$radioTower)&&(window.strappy.$radioTower=new strappy.RadioTower),this.radioTower=window.strappy.$radioTower},initStateMgr:function(){Object.isUndefined(window.strappy.$stateMgr)&&(window.strappy.$stateMgr=new strappy.StateMgr),this.stateMgr=window.strappy.$stateMgr},initViewCache:function(){Object.isUndefined(window.strappy.$viewCache)&&(window.strappy.$viewCache=new strappy.mvc.ViewCache),this.viewCache=window.strappy.$viewCache},getViewCache:function(){return this.viewCache},getBrowser:function(){Object.isNull(this.browser.name)&&(Object.isDefined(jQuery.browser.msie)?this.browser.name="ie":Object.isDefined(jQuery.browser.webkit)?this.browser.name="webkit":Object.isDefined(jQuery.browser.opera)?this.browser.name="opera":Object.isDefined(jQuery.browser.mozilla)&&(this.browser.name="mozilla"),this.browser.version=jQuery.browser.version.split(".")[0])},initChildComponents:function(){var a=null,b=null;for(var c in this.components){if(a=this.components[c].split("."),b=window[a[0]],!Object.isDefined(b))throw console.trace(),new Error('Error! component "'+this.components[c]+'" not loaded.');for(var d=1,e=a.length;e>d;d++){if(!Object.isDefined(b[a[d]]))throw console.trace(),new Error('Error! component "'+this.components[c]+'" not loaded.');b=b[a[d]]}this.components[c]=new b}},newChildComponent:function(a,b,c,d){var e=a;if(Object.isString(a)&&(e=$JSKK.namespace(a)),!Object.isDefined(e.definition))throw console.trace(),new Error('Error! component "'+a+'" not loaded.');if(!Object.isDefined(this.components[a])){var f=new e(c,d);return Object.isUndefined(b)?(Object.isArray(this.components[a])||(this.components[a]=[]),this.components[a].push(f)):this.components[b]=f,f}},newInitQueue:function(a,b){var c=new strappy.InitQueue({},this);return Object.isFunction(a)&&c.observe("onAllReady",a),Object.isFunction(b)&&c.observe("onItemReady",b),c},getCmp:function(a){if(Object.isDefined(this.components[a]))return this.components[a];throw console.trace(),new Error('Unable to get component "'+a+'". This component has not been registered.')},initControllers:function(a){this.observeOnce("onBeforeReadyState",function(){this.sendSignal(strappy.Signal.COMPONENT_IS_READY,"component",{origin:this.getIID(),ref:this.ref},this)}.bind(this));var b=this.controllers.length,c=0;b||a();for(var d=0;b>d;d++)$JSKK.require(this.my.childSpace+".controller."+this.controllers[d],function(d){this._controllers[d]=new this.my.NSObject.controller[d](this),++c==b&&a()}.bind(this,this.controllers[d]))},getController:function(a){if(Object.isDefined(this._controllers[a]))return this._controllers[a];if("State"==a)return console.warn("State controllers and stores are deprecated. All stateful related things are now part of component."),this;throw console.trace(),new Error('Error - controller "'+a+'" has not been initilized on component "'+this.my.name+'".')},initViews:function(a){var b=this.views.length,c=0;b||a();for(var d=0;b>d;d++)$JSKK.require(this.my.childSpace+".view."+this.views[d],function(d){this._views[d]=new this.my.NSObject.view[d](this),$JSKK.when(function(){return this._views[d]._templatesReady}.bind(this)).isTrue(function(){++c==b&&a()})}.bind(this,this.views[d]))},getView:function(a){if(Object.isDefined(this._views[a]))return this._views[a];throw console.trace(),new Error('Error - view "'+a+'" has not been initilized on component "'+this.my.name+'".')},setState:function(){var a=$JSKK.toArray(arguments),b={},c=null,d=!1,e={};Object.isDefined(a[1])?b[a.shift()]=a.shift():b=a.shift();for(var f in b){if(!Object.isDefined(this.stateMap[f]))throw console.trace(),new Error('Error - state property "'+f+'" has not been configured for component "'+this.my.name+'".');c=this.stateMap[f],this._state[c][f]!=b[f]&&this.fireEvent("onBeforeStateChange",this,f,b[f])!==!1&&(this._state[c][f]=b[f],c==this.$reflect("self").ACCESS_PUBLIC&&(d=!0,e[f]=b[f]),this.fireEvent("onStateChange",this,f,b[f]))}return d&&this.stateMgr.updateState(e,!0),this},getState:function(a){return Object.isDefined(this.stateMap[a])?this._state[this.stateMap[a]][a]:null},getPublicState:function(){return this._state["public"]},getPrivateState:function(){return this._state["private"]},resetState:function(){return this.setState(this.state["private"]),this.setState(this.state["public"]),this},initState:function(a){var b=this.$reflect("self"),c=null;for(c in this._state[b.ACCESS_PRIVATE])this.stateMap[c]=b.ACCESS_PRIVATE;for(c in this.state[b.ACCESS_PUBLIC])this.stateMap[c]=b.ACCESS_PUBLIC;for(c in this.state[b.ACCESS_PRIVATE])this.stateMap[c]=b.ACCESS_PRIVATE;for(c in a)this.stateMap[c]=b.ACCESS_PRIVATE;Object.extend(this._state["public"],this.state["public"]),Object.extend(this._state["private"],this.state["private"]),Object.extend(this._state["private"],a),this.fireEvent("onConfigured",this)},initStores:function(a){var b=this.stores.length,c=0;b||a();for(var d=0;b>d;d++)$JSKK.require(this.my.childSpace+".store."+this.stores[d],function(d){this._stores[d]=new this.my.NSObject.store[d](this),$JSKK.when(this._stores[d],"ready").isTrue(function(){++c==b&&a()})}.bind(this,this.stores[d]))},setReady:function(){if(!this.ready){if(this.ready=!0,this.fireEvent("onBeforeReadyState",this,!0)!==!1){var a=this.stateMgr.getState();for(var b in a)if(this.canManageStateItem(b)){var c=this.getState(b);if(!this.setState(b,a[b])){var d={};d[b]=c,this.stateMgr.updateState(d,!0)}}this.fireEvent("onReadyState",this,!0)}return this}},isReady:function(){return this.ready},attachSharedStore:function(a,b){return this._stores[a]=$JSKK.namespace(b),this},canManageStateItem:function(a){return this.stateMap[a]==this.$reflect("self").ACCESS_PUBLIC},getStore:function(a){if(Object.isDefined(this._stores[a]))return this._stores[a];throw console.trace(),new Error('Error - store "'+a+'" has not been initilized for component "'+this.my.name+'".')},insertBaseContainer:function(){var a=$(["<div",' class="'+this.$reflect("namespace").replace(/\./g,"-")+"-"+this.$reflect("name")+'-container"',' id="'+this.getIID()+'"',' style="display:none;">',"</div>"].join(""));a.data("component",this),$(this.getState("attachTo")||"body")[this.getState("attachHow")||"append"](a)},generateInstanceID:function(){for(var a="0123456789abcdefghijklmnopqrstuvwxyz".split(""),b=[],c=0;8>c;c++)b.push(a[Math.floor(25*Math.random())]);this._iid=this.getSafeID()+"-"+b.join("")},getIID:function(){return this._iid},getSafeID:function(){return(this.$reflect("namespace")+"."+this.$reflect("name")).replace(/\./g,"-")},getConfig:function(a){return console.warn("Use of getConfig deprecated as of Strappy 1.2. Use getState instead."),this.getState(a)},getID:function(){var a=[];return Object.extend(a,this.namespace),a.push(this.className),a.join(".")},getRadioTower:function(){return this.radioTower},configure:function(){console.warn('The use of configure() is deprecated as of Strappy 1.2. Pass "state" config into the Component construtor instead.')},reconfigure:function(){console.warn("The use of reconfigure() is deprecated as of Strappy 1.2. Use the new state management instead.")},getRef:function(){return this.getState("ref")},getFullRef:function(){return this.getState("fullRef")},eachChildCmp:function(a){for(var b in this.components)a(this.components[b],b);return this}})}.apply(a,arguments)})}(this),function(a){define("strappy/ShareMgr",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"ShareMgr"})({},{rootNS:null,init:function(a,b){if(this.parentCmp=a,this.rootNS=b,Object.isDefined(this.rootNS.shared)&&Object.isDefined(this.rootNS.shared.store))for(var c in this.rootNS.shared.store)Object.isFunction(this.rootNS.shared.store[c].$reflect)||(this.rootNS.shared.store[c]=new this.rootNS.shared.store[c](this.parentCmp))}})}.apply(a,arguments)})}(this),define("strappy",["./trait/ComponentConnector","./trait/signal/Send","./trait/signal/Receive","./trait/signal/Bindable","./Signal","./data/proxy/AbstractProxy","./data/proxy/Ajax","./data/proxy/BTL","./data/proxy/MemoryProxy","./data/BTL","./data/AbstractStore","./data/SingleModelStore","./data/MultiModelStore","./data/Transaction","./data/Queue","./data/stateful/Store","./SharedState","./StateMgr","./mvc/Model","./mvc/DynamicModel","./mvc/ViewCache","./mvc/View","./mvc/Controller","./mvc/stateful/Controller","./mvc/stateful/Model","./RadioTower","./InitQueue","./Component","./ShareMgr","./Strappy"]),define("strappy/main",function(){}),$JSKK.Class.create("Strappy")({VERSION:"1.2.0",VERSION_MAJOR:1,VERSION_MINOR:2,VERSION_MICRO:0,VERSION_STAGE:"",VERSION_STAGE_NUM:0,config:{autoInitStateMgr:!1}},{}),define("strappy/Strappy",function(){}),function(a){define("strappy/ccl/CCL",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy",$name:"CCL"})({version:"1.0.0",Signal:{SWITCH:"strappy.signal.ccl.switch",SPINNER_CHANGE:"strappy.signal.ccl.spinner.change"},Type:{INSTRUCTION:"strappy.type.ccl.instruction",CHANGE:"strappy.type.ccl.change"}},{})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/trait/Containable",["strappy/Strappy"],function(){return function(){$JSKK.Trait.create({$namespace:"strappy.ccl.trait",$name:"Containable",$requires:["strappy.ccl.component.container.Container"]})({initChildren:function(){this.childInstances=[],this.readyChildren=0;var a=this.getParentComponent(),b=this.getState("children");if(Object.isString(this.getState("html")))Object.isNull(this.getState("bodySelector"))?this.getView("Main").getContainer().html(this.getState("html")):this.getView("Main").getContainer().find(this.getState("bodySelector")).html(this.getState("html")),a.fireEvent("onChildReady",this.getState("fullRef")+".html",this);else if(!Object.isNull(b)){Object.isArray(b)||(b=[b]);for(var c=0,d=b.length;d>c;c++)this.addChild(b[c],c)}},addChild:function(a,b){var c=this.cmp(),d=this.getState("children")||[];if(Object.isUndefined(a.cmp)&&(a.cmp=Object.isNull(this.getState("defaultChildCmp"))?"strappy.ccl.component.container.Container":this.getState("defaultChildCmp")),this.getState("ref")&&Object.isDefined(a.ref)){var e="";e=this.getState("parentRef")?this.getState("parentRef")+".":this.$reflect("name")+".",a.parentRef=e+this.getState("ref"),a.fullRef=a.parentRef+"."+a.ref}else Object.isDefined(a.ref)&&(a.parentRef=this.$reflect("name"),a.fullRef=a.parentRef+"."+a.ref);var f=Object.clone(a);f.attachTo="#"+this.getIID(),Object.isNull(this.getState("bodySelector"))||(f.attachTo+=" "+this.getState("bodySelector")),delete f.cmp;var g=function(b){if(++this.readyChildren===d.length){for(var e=null,f=null,g=0,h=d.length;h>g;g++)if(e=$("#"+this.childInstances[g].getIID()),f=$(":nth-child("+(g+1)+")",d[g].attachTo),e[0]!=f[0]){var i=$(d[0].appendTo);i.children().remove();for(var j=0,k=d.length;k>j;j++)i.append(d[g]);break}this.fireEvent("onAllChildrenReady")}c.fireEvent("onChildReady",a.fullRef,b)}.bind(this),h=function(){var a=$JSKK.toArray(arguments);a.unshift("onChildReady"),c.fireEvent.apply(c,a)}.bind(this);Object.isDefined(a.events)?(Object.isFunction(a.events.onReadyState)&&(a.events.onReadyState=a.events.onReadyState.join(g)),Object.isFunction(a.events.onChildReady)&&(a.events.onChildReady=a.events.onChildReady.join(h))):a.events={onReadyState:g,onChildReady:h},this.childInstances[b]=c.newChildComponent(a.cmp,a.ref,f,a.events)}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/trait/Animatable",["strappy/Strappy"],function(){return function(){$JSKK.Trait.create({$namespace:"strappy.ccl.trait",$name:"Animatable"})({enableAnimations:function(){this.getContainer().css({transition:"all .25s linear","-o-transition":"all .25s linear","-moz-transition":"all .25s linear","-webkit-transition":"all .25s linear"})},disableAnimations:function(){this.getContainer().css({transition:"none","-o-transition":"none","-moz-transition":"none","-webkit-transition":"none"})}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/trait/Pluploadable",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.trait",$name:"Pluploadable",$uses:["$JSKK.trait.Observable"]})({},{initUploader:function(){this.uploader=new plupload.Uploader({runtimes:this.getState("upload_runtimes"),browse_button:this.getState("upload_browse_button"),container:this.getState("upload_container"),drop_element:this.getState("upload_drop_element"),max_file_size:this.getState("upload_max_file_size"),url:this.getState("upload_url"),flash_swf_url:this.getState("upload_flash_swf_url"),silverlight_xap_url:this.getState("upload_silverlight_xap_url"),filters:this.getState("upload_filters")||!1,multi_selection:this.getState("upload_multi_selection"),max_file_count:1}),this.uploader.bind("Init",this.onInit.bind(this));var a=$("#"+this.uploader.settings.drop_element);a.bind("dragover",this.onFileDragOver.bind(this)),a.bind("dragexit dragleave drop",this.onDragOffDrop.bind(this)),this.uploader.init(),this.uploader.bind("FilesAdded",this.onFilesAdded.bind(this)),this.uploader.bind("UploadProgress",this.onUploadProgress.bind(this)),this.uploader.bind("Error",this.onFileError.bind(this)),this.uploader.bind("FileUploaded",this.onFileUploaded.bind(this))},uploadFiles:function(){this.uploader.start()},onInit:function(a,b){this.fireEvent("onInit",this,a,b)},onFilesAdded:function(a,b){this.fireEvent("onFilesAdded",this,a,b)},onUploadProgress:function(a,b){this.fireEvent("onUploadProgress",this,a,b)
},onFileError:function(a,b){this.fireEvent("onFileError",this,a,b)},onFileUploaded:function(a,b){this.fireEvent("onFileUploaded",this,a,b)},onFileDragOver:function(a,b){this.fireEvent("onFileDragOver",this,a,b)},onDragOffDrop:function(a,b){this.fireEvent("onDragOffDrop",this,a,b)}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/application/Controller",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.application",$name:"Controller",$extends:"strappy.mvc.Controller",$abstract:!0,$requires:["strappy.data.BTL"]})({},{events:{onStateReady:!0,onAPIReady:!0,onSharedMgrReady:!0,onReady:!0},_selfReady:!1,_stateReady:!1,_APIReady:!1,_sharedMgrReady:!1,_rootNS:null,BTL:!1,API:null,sharedMgr:null,onReady:$JSKK.Class.ABSTRACT_METHOD,init:function(){this._rootNS=$JSKK.namespace(this.$reflect("namespace").split(".").first()),this.init.$parent(),this.cmp().observe("onReadyState",this.onReadyState.bind(this)),Object.isString(this.BTL)?(this.observeOnce("onAPIReady",function(){this.initSharedMgr()}),this.initAPI()):this.initSharedMgr(),$JSKK.when(function(){return this._stateReady&&this._APIReady&&this._sharedMgrReady}.bind(this)).isTrue(function(){this._selfReady=!0,this.fireEvent("onReady",this),this.onReady()}.bind(this))},onReadyState:function(){this._stateReady=!0},initAPI:function(){this.API=new strappy.data.BTL({url:this.BTL}),this.API.onReady(function(){this._rootNS.BTL=this.API,this._rootNS.API=this.API.API,this._APIReady=!0,this.fireEvent("onAPIReady",this,this.API)}.bind(this))},initSharedMgr:function(){return this.sharedMgr=new strappy.ShareMgr(this,this._rootNS),this._sharedMgrReady=!0,this.fireEvent("onSharedMgrReady",this,this.sharedMgr),this}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/controller/Router",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.controller",$name:"Router",$extends:"strappy.mvc.Controller"})({},{routes:[],init:function(){this.init.$parent(),this.getView("Structure").observe("onReady",this.onViewReady.bind(this))},onViewReady:function(){$("body").on("click","[data-strappy-route]",null,this.onClickableRoute.bind(this))},onClickableRoute:function(a){var b=$(a.currentTarget).data("strappy-route");console.debug(b),Object.isString(b)&&this.goTo(b)},isValidRoute:function(a){return this.routes.inArray(a)},goTo:function(a){this.getStore("State").set("p",a)},routeTo:function(a){$JSKK.when(function(){return this.getStore("State").get("structureReady")}.bind(this)).isTrue(function(){for(var b=this.getParentComponent(),c=a.split("/"),d=null,e=null,f=null,g=b._controllers,h=null,i=[],j=0,k=c.length;k>j;j++){if(d=c[j].substring(0,1),e=c[j].substring(1),f=d.toUpperCase()+e,Object.isDefined(g[f])){for(g=g[f],h=c[++j],j++;c[j];)i.push(c[j]),j++;g[h].apply(g,i);break}if(!Object.isDefined(g[c[j]]))return;g=g[c[j]]}}.bind(this))}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/container/Container",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.container",$name:"Container",$extends:"strappy.Component"})({},{events:{onChildReady:!0},state:{"private":{attachTo:null,ref:null,cmp:null,signalKey:null,cls:null,style:null,autoShow:!0,scrollable:!0,children:null,layout:"auto",activeCard:null}},components:{},stores:[],views:["Main"],controllers:["Main","AutoLayout","CardLayout","HTMLLayout"]})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/container/controller/Main",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.container.controller",$name:"Main",$extends:"strappy.mvc.Controller"})({},{layouts:["auto","html","card"],onAfterCmpInit:function(){this.getView("Main").observe("onReady",function(){this.cmp().setReady()}.bind(this))},onBeforeChange:function(){return!0},onViewReady:function(a){if(this.setViewReadyState(a.$reflect("name")),!this.hasValidLayout())throw console.trace(),new Error("Container has been configured with an invalid layout.");this.setReady()},hasValidLayout:function(){return this.layouts.inArray(this.getState("layout"))}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/container/controller/AutoLayout",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.container.controller",$name:"AutoLayout",$extends:"strappy.mvc.Controller",$uses:["strappy.ccl.trait.Containable"]})({},{onAfterCmpInit:function(){"auto"==this.getState("layout")&&(this.getState("autoShow")&&this.getView("Main").getContainer().show(),this.initChildren())},onSignalShow:function(){this.getView("Main").getContainer().show()},onSignalHide:function(){this.getView("Main").getContainer().hide()}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/container/controller/CardLayout",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.container.controller",$name:"CardLayout",$extends:"strappy.mvc.Controller",$uses:["strappy.ccl.trait.Containable"]})({},{cards:{},onAfterCmpInit:function(){if("card"==this.getState("layout")){this.getState("autoShow")&&this.getView("Main").getContainer().show();var a=(this.getState("children"),this.getState("activeCard"));this.cmp().observe("onChildReady",function(b){var c=b.split(".").last(),d=this.getCmp(c),e=null;if(c==a)for(e in d._views)d._views[e].getContainer().show();else for(e in d._views)d._views[e].getContainer().hide()}),this.initChildren()}},onSwitchInstruction:function(a){this.showCard(a.getBody().card)},hideAllChildComponents:function(){var a=this.getParentComponent().components;for(var b in a)this.hideChildComponent(b)},showCard:function(a){this.setState("activeCard",a);var b=null;this.cmp().eachChildCmp(function(c,d){if(a==d)for(b in c._views)c._views[b].getContainer().show();else for(b in c._views)c._views[b].getContainer().hide()})}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/container/controller/HTMLLayout",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.container.controller",$name:"HTMLLayout",$extends:"strappy.mvc.Controller"})({},{onAfterCmpInit:function(){"html"===this.getState("layout")&&(this.cmp().observe("onStateChange",this.redraw.bind(this)),this.redraw(),this.getView("Main").show())},redraw:function(){this.getView("Main").getContainer().html("").append(this.getState("html"))},onChangeCard:function(){}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/container/view/Main",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.container.view",$name:"Main",$extends:"strappy.mvc.View",$uses:["strappy.ccl.trait.Scrollable"]})({},{templates:{},onAfterCmpInit:function(){this.getContainer().addClass(this.getState("cls")),this.getContainer().addClass(this.getState("layout")),this.getState("style")&&this.getContainer().css(this.getState("style")),this.getState("scrollable")&&this.getContainer().addClass("jspscroll")},bindDOMEvents:function(){},onModelLockChange:function(){},syncView:function(){},getContainerSelector:function(){return"#"+this.getIID()}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/uploader/Uploader",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.uploader",$name:"Uploader",$extends:"strappy.Component"})({},{state:{"private":{html:"",upload_runtimes:"html5,flash,silverlight,gears,browserplus",upload_container:null,upload_browse_button:null,upload_max_file_size:"500mb",upload_url:"/",upload_flash_swf_url:"/lib/plupload/plupload.flash.swf",upload_silverlight_xap_url:"/lib/plupload/plupload.silverlight.xap",upload_container:null,upload_drop_element:null,upload_multi_selection:!0,upload_filters:null}},components:{},stores:[],views:["Main"],controllers:["Main"]})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/uploader/controller/Main",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.uploader.controller",$name:"Main",$extends:"strappy.mvc.Controller",$uses:["strappy.ccl.trait.Pluploadable"]})({},{events:{onInit:!0,onFilesAdded:!0,onUploadProgress:!0,onError:!0,onFileUploaded:!0},uploader:null,onAfterCmpInit:function(){var a=this.getView("Main");a.observe("onReady",this.onViewReady.bind(this)),this.cmp().setReady()},onViewReady:function(){var a=this.getView("Main");a.syncView(),Object.isNull(this.getState("upload_container"))&&this.setState("upload_container",this.getIID()),this.initUploader()},onSignalShow:function(){this.getView("Main").show()},onSignalHide:function(){this.getView("Main").hide()}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/component/uploader/view/Main",["strappy/Strappy"],function(){return function(){$JSKK.Class.create({$namespace:"strappy.ccl.component.uploader.view",$name:"Main",$extends:"strappy.mvc.View"})({},{templates:{},onAfterCmpInit:function(){},bindDOMEvents:function(){this.bindDOMEvent("click","#"+this.getState("upload_upload_button"),"controller:Main","uploadFiles")},syncView:function(){this.getContainer().html("").append(this.getState("html"))}})}.apply(a,arguments)})}(this),function(a){define("strappy/ccl/main",["strappy/Strappy"],function(){return function(){requirejs.config({}),define("strappy/ccl",["./CCL","./trait/Containable","./trait/Animatable","./trait/Pluploadable","./component/application/Controller","./controller/Router","./component/container/Container","./component/container/controller/Main","./component/container/controller/AutoLayout","./component/container/controller/CardLayout","./component/container/controller/HTMLLayout","./component/container/view/Main","./component/uploader/Uploader","./component/uploader/controller/Main","./component/uploader/view/Main"])}.apply(a,arguments)})}(this);